import{o as k,c as T,b as h,d as W,e as y,L as U,j as se,E as le,n as P,a as ae,U as O,t as ee,aE as re,aF as ie,P as f,R as p,V as L,S as ce,u as w,B as ue,F as de,k as me,ar as fe,aq as ve}from"./vue-CpysqPi9.js";import{E as H,b as te,a as ne,u as pe,c as he,d as _e,e as ge,f as ye,g as we,h as be,i as ke}from"./index-Bm7lfUbx.js";import{E as Ce}from"./index-B2ZK0vRS.js";import{E as Ee}from"./index-NJC_7Evv.js";const Ve={style:{"vertical-align":"-0.15em",fill:"currentcolor"},viewBox:"0 0 1024 1024",width:"1em",height:"1em"},Se=h("path",{fill:"currentColor",d:"M224 448a32 32 0 0 0-32 32v384a32 32 0 0 0 32 32h576a32 32 0 0 0 32-32V480a32 32 0 0 0-32-32zm0-64h576a96 96 0 0 1 96 96v384a96 96 0 0 1-96 96H224a96 96 0 0 1-96-96V480a96 96 0 0 1 96-96"},null,-1),Te=h("path",{fill:"currentColor",d:"M512 544a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V576a32 32 0 0 1 32-32m192-160v-64a192 192 0 1 0-384 0v64zM512 64a256 256 0 0 1 256 256v128H256V320A256 256 0 0 1 512 64"},null,-1),$e=[Se,Te];function Me(e,t){return k(),T("svg",Ve,[...$e])}const Re={name:"ep-lock",render:Me},Be={style:{"vertical-align":"-0.15em",fill:"currentcolor"},viewBox:"0 0 1024 1024",width:"1em",height:"1em"},Ae=h("path",{fill:"currentColor",d:"M512 512a192 192 0 1 0 0-384a192 192 0 0 0 0 384m0 64a256 256 0 1 1 0-512a256 256 0 0 1 0 512m320 320v-96a96 96 0 0 0-96-96H288a96 96 0 0 0-96 96v96a32 32 0 1 1-64 0v-96a160 160 0 0 1 160-160h448a160 160 0 0 1 160 160v96a32 32 0 1 1-64 0"},null,-1),De=[Ae];function Ie(e,t){return k(),T("svg",Be,[...De])}const Le={name:"ep-user",render:Ie},Ne={style:{"vertical-align":"-0.15em",fill:"currentcolor"},viewBox:"0 0 1024 1024",width:"1em",height:"1em"},Ue=h("path",{fill:"currentColor",d:"m759.936 805.248l-90.944-91.008A254.9 254.9 0 0 1 512 768a254.9 254.9 0 0 1-156.992-53.76l-90.944 91.008A382.46 382.46 0 0 0 512 896c94.528 0 181.12-34.176 247.936-90.752m45.312-45.312A382.46 382.46 0 0 0 896 512c0-94.528-34.176-181.12-90.752-247.936l-91.008 90.944C747.904 398.4 768 452.864 768 512s-20.096 113.6-53.76 156.992zm-45.312-541.184A382.46 382.46 0 0 0 512 128c-94.528 0-181.12 34.176-247.936 90.752l90.944 91.008A254.9 254.9 0 0 1 512 256c59.136 0 113.6 20.096 156.992 53.76zm-541.184 45.312A382.46 382.46 0 0 0 128 512c0 94.528 34.176 181.12 90.752 247.936l91.008-90.944A254.9 254.9 0 0 1 256 512c0-59.136 20.096-113.6 53.76-156.992zm417.28 394.496a194.6 194.6 0 0 0 22.528-22.528C686.912 602.56 704 559.232 704 512a191.23 191.23 0 0 0-67.968-146.56A191.3 191.3 0 0 0 512 320a191.23 191.23 0 0 0-146.56 67.968C337.088 421.44 320 464.768 320 512a191.23 191.23 0 0 0 67.968 146.56C421.44 686.912 464.768 704 512 704c47.296 0 90.56-17.088 124.032-45.44M512 960a448 448 0 1 1 0-896a448 448 0 0 1 0 896"},null,-1),Fe=[Ue];function je(e,t){return k(),T("svg",Ne,[...Fe])}const ze={name:"ep-help",render:je},Xe={style:{"vertical-align":"-0.15em",fill:"currentcolor"},viewBox:"0 0 1024 1024",width:"1em",height:"1em"},qe=h("path",{fill:"currentColor",d:"M406.656 706.944L195.84 496.256a32 32 0 1 0-45.248 45.248l256 256l512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"},null,-1),xe=[qe];function Ye(e,t){return k(),T("svg",Xe,[...xe])}const Pe={name:"ep-check",render:Ye},D=Math.PI;function J(e,t){return e+t}function Oe(e){return e*e}function K(e,t,o,n,r,u){e.beginPath(),e.moveTo(t,o),e.arc(t+n/2,o-r+2,r,.72*D,2.26*D),e.lineTo(t+n,o),e.arc(t+n+r-2,o+n/2,r,1.21*D,2.78*D),e.lineTo(t+n,o+n),e.lineTo(t,o+n),e.arc(t+r-2,o+n/2,r+.4,2.76*D,1.24*D,!0),e.lineTo(t,o),e.lineWidth=2,e.fillStyle="rgba(255, 255, 255, 0.7)",e.strokeStyle="rgba(255, 255, 255, 0.7)",e.stroke(),e[u](),e.globalCompositeOperation="destination-over"}function He(e,t){const o=document.createElement("img");return o.crossOrigin="Anonymous",o.onload=t,o.onerror=()=>{o.src=Z(e)},o.src=Z(e),o}function Q(e,t){return Math.round(Math.random()*(t-e)+e)}function Z(e){const t=e.length;return t>0?e[Q(0,t-1)]:"https://source.unsplash.com/300x150/?book,library"}function Qe(e,t,o={leading:!0,trailing:!0}){const{leading:n,trailing:r,resultCallback:u}=o;let s=0,_=null;const b=function(...d){return new Promise((m,i)=>{const l=new Date().getTime();!s&&!n&&(s=l);const c=t-(l-s);if(c<=0){_&&(clearTimeout(_),_=null);const a=e.apply(this,d);u&&u(a),m(a),s=l;return}r&&!_&&(_=setTimeout(()=>{_=null,s=n?new Date().getTime():0;const a=e.apply(this,d);u&&u(a),m(a)},c))})};return b.cancel=function(){_&&clearTimeout(_),_=null,s=0},b}function Ze(){const e=U({x:0,y:0}),t=y(!1),o=y(!1),n=y(0),r=y([]);return{origin:e,success:t,isMouseDown:o,timestamp:n,trail:r,start:d=>{t.value||(d instanceof MouseEvent?(e.x=d.clientX,e.y=d.clientY):(e.x=d.changedTouches[0].pageX,e.y=d.changedTouches[0].pageY),o.value=!0,n.value=Date.now())},move:(d,m,i)=>{if(!o.value)return!1;let l=0,c=0;if(m instanceof MouseEvent?(l=m.clientX-e.x,c=m.clientY-e.y):(l=m.changedTouches[0].pageX-e.x,c=m.changedTouches[0].pageY-e.y),l<0||l+38>=d)return!1;i(l),r.value.push(c)},end:(d,m)=>{if(!o.value||(o.value=!1,(d instanceof MouseEvent?d.clientX:d.changedTouches[0].pageX)===e.x))return!1;n.value=Date.now()-n.value,m(n.value)},verify:(d,m,i)=>{const l=r.value,c=l.reduce(J)/l.length,a=l.map(C=>C-c),v=Math.sqrt(a.map(Oe).reduce(J)/l.length),$=parseInt(d);return i=i<=1?1:i>10?10:i,{spliced:Math.abs($-m)<=i,TuringTest:c!==v}}}}var We=(e,t)=>{const o=e.__vccOpts||e;for(const[n,r]of t)o[n]=r;return o};const Ge=W({name:"SlideVerify",props:{l:{type:Number,default:42},r:{type:Number,default:10},w:{type:Number,default:310},h:{type:Number,default:155},sliderText:{type:String,default:"Slide filled right"},accuracy:{type:Number,default:5},show:{type:Boolean,default:!0},imgs:{type:Array,default:()=>[]},interval:{type:Number,default:50}},emits:["success","again","fail","refresh"],setup(e,{emit:t}){const{imgs:o,l:n,r,w:u,h:s,accuracy:_,interval:b}=e,d=y(!0),m=y(0),i=y(0),l=U({containerActive:!1,containerSuccess:!1,containerFail:!1}),c=U({iconCls:"arrow-right",width:"0",left:"0"}),a=y(),v=y(),$=y(),C=y();let E;const{success:M,start:N,move:F,end:j,verify:z}=Ze(),I=()=>{var g,S;M.value=!1,l.containerActive=!1,l.containerSuccess=!1,l.containerFail=!1,c.iconCls="arrow-right",c.left="0",c.width="0",a.value.style.left="0",(g=C.value)==null||g.clearRect(0,0,u,s),(S=v.value)==null||S.clearRect(0,0,u,s),a.value.width=u,E.src=Z(o)},X=()=>{I(),t("refresh")};function q(g){c.left=g+"px";let S=(u-40-20)/(u-40)*g;a.value.style.left=S+"px",l.containerActive=!0,c.width=g+"px"}function V(g){const{spliced:S,TuringTest:R}=z(a.value.style.left,m.value,_);if(S){if(_===-1){l.containerSuccess=!0,c.iconCls="success",M.value=!0,t("success",g);return}R?(l.containerSuccess=!0,c.iconCls="success",M.value=!0,t("success",g)):(l.containerFail=!0,c.iconCls="fail",t("again"))}else l.containerFail=!0,c.iconCls="fail",t("fail"),setTimeout(()=>{I()},1e3)}const x=Qe(g=>{F(u,g,q)},b),Y=g=>{j(g,V)};return se(()=>{var g,S;const R=(g=$.value)==null?void 0:g.getContext("2d"),B=(S=a.value)==null?void 0:S.getContext("2d");C.value=R,v.value=B,E=He(o,()=>{d.value=!1;const A=n+r*2+3;if(m.value=Q(A+10,u-(A+10)),i.value=Q(10+r*2,s-(A+10)),R&&B){K(R,m.value,i.value,n,r,"fill"),K(B,m.value,i.value,n,r,"clip"),R.drawImage(E,0,0,u,s),B.drawImage(E,0,0,u,s);const G=i.value-r*2-1,oe=B.getImageData(m.value,G,A,A);a.value.width=A,B.putImageData(oe,0,G)}}),document.addEventListener("mousemove",x),document.addEventListener("mouseup",Y)}),le(()=>{document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",Y)}),{block:a,canvas:$,loadBlock:d,containerCls:l,sliderBox:c,refresh:X,sliderDown:N,touchStartEvent:N,touchMoveEvent:x,touchEndEvent:Y}}}),Je=e=>(re("data-v-f61c42f2"),e=e(),ie(),e),Ke=["width","height"],et=Je(()=>h("i",{class:"iconfont icon-refresh"},null,-1)),tt=[et],nt=["width","height"],ot={class:"slide-verify-slider-text"};function st(e,t,o,n,r,u){return k(),T("div",{id:"slideVerify",class:"slide-verify",style:O({width:e.w+"px"}),onselectstart:"return false;"},[h("div",{class:P({"slider-verify-loading":e.loadBlock})},null,2),h("canvas",{ref:"canvas",width:e.w,height:e.h},null,8,Ke),e.show?(k(),T("div",{key:0,class:"slide-verify-refresh-icon",onClick:t[0]||(t[0]=(...s)=>e.refresh&&e.refresh(...s))},tt)):ae("",!0),h("canvas",{ref:"block",width:e.w,height:e.h,class:"slide-verify-block"},null,8,nt),h("div",{class:P(["slide-verify-slider",{"container-active":e.containerCls.containerActive,"container-success":e.containerCls.containerSuccess,"container-fail":e.containerCls.containerFail}])},[h("div",{class:"slide-verify-slider-mask",style:O({width:e.sliderBox.width})},[h("div",{class:"slide-verify-slider-mask-item",style:O({left:e.sliderBox.left}),onMousedown:t[1]||(t[1]=(...s)=>e.sliderDown&&e.sliderDown(...s)),onTouchstart:t[2]||(t[2]=(...s)=>e.touchStartEvent&&e.touchStartEvent(...s)),onTouchmove:t[3]||(t[3]=(...s)=>e.touchMoveEvent&&e.touchMoveEvent(...s)),onTouchend:t[4]||(t[4]=(...s)=>e.touchEndEvent&&e.touchEndEvent(...s))},[h("i",{class:P(["slide-verify-slider-mask-item-icon","iconfont","icon-".concat(e.sliderBox.iconCls)])},null,2)],36)],4),h("span",ot,ee(e.sliderText),1)],2)],4)}var lt=We(Ge,[["render",st],["__scopeId","data-v-f61c42f2"]]);const at=""+new URL("1-EumNmZkV.jpg",import.meta.url).href,rt=""+new URL("2-D9DNpwaZ.jpg",import.meta.url).href,it=""+new URL("3-_rRQx6ox.jpg",import.meta.url).href,ct=""+new URL("4-BnIkuOXy.jpg",import.meta.url).href,ut=""+new URL("5-BV1RcnDC.jpg",import.meta.url).href,dt=""+new URL("6-CSDynz2s.jpg",import.meta.url).href,mt={key:0,class:"verify-success"},ft=W({__name:"login-verify",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{expose:t,emit:o}){const n=o,r=[at,rt,it,ct,ut,dt],u=y(),s=y(!1);function _(){var i;(i=u.value)==null||i.refresh(),me(()=>{s.value=!0})}function b(){var i;H.warning("系统检测到异常，请重试！"),(i=u.value)==null||i.refresh()}function d(i){n("update:modelValue",!0),s.value=!1}function m(){H.error("验证失败，请重试！")}return t({visible:s}),(i,l)=>{const c=Pe,a=te,v=ze,$=ne,C=Ce;return k(),T(de,null,[i.modelValue?(k(),T("div",mt,[f(a,null,{default:p(()=>[f(c)]),_:1}),L(" 验证通过 ")])):(k(),ce($,{key:1,type:"info",long:"",onClick:_},{icon:p(()=>[f(v)]),default:p(()=>[L(" 点击按钮完成验证 ")]),_:1})),f(C,{modelValue:w(s),"onUpdate:modelValue":l[0]||(l[0]=E=>ue(s)?s.value=E:null),width:"460px"},{default:p(()=>[f(w(lt),{ref_key:"block",ref:u,"slider-text":"请向右滑动滑块完成验证",w:420,h:220,imgs:r,show:!1,class:"slide-verify-custom",onAgain:b,onSuccess:d,onFail:m},null,512)]),_:1},8,["modelValue"])],64)}}}),vt={class:"login-container"},pt={class:"login-wrapper"},ht=h("div",{class:"login-banner"},null,-1),_t={class:"login-form"},gt={class:"login-title"},Ct=W({__name:"index",setup(e){const t={username:[{required:!0,message:"请输入用户名"},{min:3,message:"用户名至少为 3 个字符"},{max:12,message:"用户名最多为 12 个字符"}],password:[{required:!0,message:"请输入密码"},{min:5,message:"密码至少为 5 个字符"},{max:18,message:"密码最多为 18 个字符"}]},o=fe("app-login",{username:"admin",password:"admin",remember:!0}),n=U({username:o.value.username,password:o.value.password,remember:o.value.remember,verify:!1}),r=pe(),u=he(),{currentRoute:s,push:_}=ve(),b=y(),d=y(),m=y(!1);function i(){const{redirect:a,...v}=s.value.query;_({path:a||"/",query:{...v}})}async function l(){m.value=!0;try{await u.login(n),i(),H.success("欢迎使用！");const a=n.remember;o.value.username=a?n.username:"",o.value.password=a?n.password:"",o.value.remember=a}catch(a){console.error(a)}m.value=!1}function c(){var a;(a=b.value)==null||a.validate(async v=>{if(v){if(!n.verify){d.value.visible=!0;return}l()}})}return(a,v)=>{const $=Le,C=te,E=ge,M=ye,N=Re,F=we,j=be,z=Ee,I=ne,X=ke,q=_e;return k(),T("div",vt,[h("div",pt,[ht,h("div",_t,[h("div",gt," 欢迎登录 "+ee(w(r).title),1),f(q,{ref_key:"formRef",ref:b,"hide-required-asterisk":"",model:w(n),rules:t,onSubmit:c},{default:p(()=>[f(M,{prop:"username"},{default:p(()=>[f(E,{modelValue:w(n).username,"onUpdate:modelValue":v[0]||(v[0]=V=>w(n).username=V),modelModifiers:{trim:!0},"validate-event":!1,placeholder:"请输入账号"},{prefix:p(()=>[f(C,null,{default:p(()=>[f($)]),_:1})]),_:1},8,["modelValue"])]),_:1}),f(M,{prop:"password"},{default:p(()=>[f(E,{modelValue:w(n).password,"onUpdate:modelValue":v[1]||(v[1]=V=>w(n).password=V),modelModifiers:{trim:!0},"validate-event":!1,type:"password","show-password":"",placeholder:"请输入密码"},{prefix:p(()=>[f(C,null,{default:p(()=>[f(N)]),_:1})]),_:1},8,["modelValue"])]),_:1}),f(M,{prop:"verify"},{default:p(()=>[f(ft,{ref_key:"verifyRef",ref:d,modelValue:w(n).verify,"onUpdate:modelValue":v[2]||(v[2]=V=>w(n).verify=V)},null,8,["modelValue"])]),_:1}),f(M,null,{default:p(()=>[f(z,{justify:"space-between",style:{width:"100%"}},{default:p(()=>[f(F,{modelValue:w(n).remember,"onUpdate:modelValue":v[3]||(v[3]=V=>w(n).remember=V),label:"记住密码"},null,8,["modelValue"]),f(j,{type:"primary",underline:!1},{default:p(()=>[L(" 忘记密码 ")]),_:1})]),_:1})]),_:1}),f(X,{direction:"vertical",fill:"",style:{width:"100%"}},{default:p(()=>[f(I,{long:"",type:"primary",loading:w(m),onClick:c},{default:p(()=>[L(" 登录 ")]),_:1},8,["loading"]),f(I,{long:"",text:""},{default:p(()=>[L(" 注册账号 ")]),_:1})]),_:1})]),_:1},8,["model"])])])])}}});export{Ct as default};
